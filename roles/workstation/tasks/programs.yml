- name: install arch specific software
  package:
    name:
      # Shell
      - python-pywal
      - git
      - base-devel
      - htop
      - zsh
      - zsh-syntax-highlighting
      - vim
      - bat
      - ranger
      - cmus
      - cmatrix
      - w3m
      - neofetch
      - powertop
      - youtube-dl
      - sudo
      - dmenu
      - fail2ban
      - powerline
      - powerline-fonts
      - powerline-vim
      - zsh-syntax-highlighting
      - zsh-autosuggestions
      - wget
      # Security
      - nmap
      - ufw
      - shellharden
      # Graphical
      - dolphin
      - flameshot   # look into better solutions
      - rofi
      - gnome-terminal
      - firefox
      - signal-desktop
      - ttf-hack
      # - atom (find replacement)
      # - containerd  (look into configuring this first)
  when: ansible_distribution == "Archlinux"

- name: debian specific software
  package:
    name:
      # Shell
      - htop
      - git
      - zsh
      - zsh-syntax-highlighting
      - vim
      - bat
      - ranger
      - cmus
      - cmatrix
      - w3m
      - neofetch
      - powertop
      - youtube-dl
      - sudo
      - dmenu
      - fail2ban
      - zsh-syntax-highlighting
      # Security
      - nmap
      - ufw
      # - shellharden
      # Graphical
      - dolphin
      - flameshot   # look into better solutions
      - rofi
      - gnome-terminal # look into better solutions
      - firefox
      - fonts-hack-ttf
      # - containerd  (look into configuring this first)
      # - atom
      # - python-pywal
      # - signal-desktop (https://itsfoss.com/install-signal-ubuntu/)
  when: ansible_distribution in ["Debian", "Ubuntu"]

- name: Clone yay
  become_user: "{{ users[0] }}"
  git:
    repo: https://aur.archlinux.org/yay-bin.git
    dest: "~/repo/yay"
    update: true
  when: ansible_distribution == "Archlinux"

- name: Build and install yay
  become_user: "{{ users[0] }}"
  command:
    chdir: "~/repo/yay"
    cmd: "makepkg -sfi --noconfirm"
    creates: /usr/bin/yay
  when: ansible_distribution == "Archlinux"

# add packages w/ "yay -S pkg --noconfirm"
# remove packages w/ "yay -Rns pkg --noconfirm"
# clean unwanted dependencies w/ "ysy -Yc --noconfirm"

- name: install oh-my-zsh
  become_user: "{{ users[0] }}"
  shell:
    cmd: "{{ item }}"
  with_items:
    - "sh -c \"(wget https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)\""
    - "git clone --depth=1 https://github.com/romkatv/powerlevel10k.git ~/.oh-my-zsh/custom/themes/powerlevel10k"
  ignore_errors: true

- name: link installed oh-my-zsh plugins (arch)
  become_user: "{{ users[0] }}"
  ansible.builtin.file:
    src: "{{ item.src }}"
    dest: "{{ item.dest }}"
    state: link
  loop:
    - src: "/usr/share/zsh/plugins/zsh-syntax-highlighting"
      dest: "~/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting"
    - src: "/usr/share/zsh/plugins/zsh-autosuggestions"
      dest: "~/.oh-my-zsh/custom/plugins/zsh-autosuggestions"
  when: ansible_distribution == "Archlinux"
